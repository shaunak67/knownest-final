{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":91,"index":91}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":92},"end":{"line":2,"column":69,"index":161}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    login: async () => null,\n    logout: async () => {},\n    checkAuth: async () => {}\n  });\n  const useAuth = () => (0, _react.useContext)(AuthContext);\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const checkAuth = (0, _react.useCallback)(async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        if (!storedToken) {\n          setUser(null);\n          setIsLoading(false);\n          return;\n        }\n        const resp = await fetch(`${BACKEND_URL}/api/auth/me`, {\n          headers: {\n            'Authorization': `Bearer ${storedToken}`\n          },\n          credentials: 'include'\n        });\n        if (resp.ok) {\n          const userData = await resp.json();\n          setUser(userData);\n        } else {\n          setUser(null);\n          await AsyncStorage.default.removeItem('session_token');\n        }\n      } catch {\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, [checkAuth]);\n    const login = async sessionId => {\n      try {\n        const resp = await fetch(`${BACKEND_URL}/api/auth/session`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            session_id: sessionId\n          }),\n          credentials: 'include'\n        });\n        if (!resp.ok) return null;\n        const userData = await resp.json();\n        // Store session token from response headers or extract from cookie\n        const cookies = resp.headers.get('set-cookie');\n        if (cookies) {\n          const tokenMatch = cookies.match(/session_token=([^;]+)/);\n          if (tokenMatch) {\n            await AsyncStorage.default.setItem('session_token', tokenMatch[1]);\n          }\n        }\n        // Also try storing from the session_id exchange\n        if (userData.session_token) {\n          await AsyncStorage.default.setItem('session_token', userData.session_token);\n        }\n        setUser(userData);\n        return userData;\n      } catch {\n        return null;\n      }\n    };\n    const logout = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        await fetch(`${BACKEND_URL}/api/auth/logout`, {\n          method: 'POST',\n          headers: storedToken ? {\n            'Authorization': `Bearer ${storedToken}`\n          } : {},\n          credentials: 'include'\n        });\n      } catch {/* ignore */}\n      await AsyncStorage.default.removeItem('session_token');\n      setUser(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        login,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 5\n    }, this);\n  };\n});","lineCount":136,"map":[[13,2,31,0,"Object"],[13,8,31,0],[13,9,31,0,"defineProperty"],[13,23,31,0],[13,24,31,0,"exports"],[13,31,31,0],[14,4,31,0,"enumerable"],[14,14,31,0],[15,4,31,0,"get"],[15,7,31,0],[15,18,31,0,"get"],[15,19,31,0],[16,6,31,0],[16,13,31,0,"useAuth"],[16,20,31,0],[17,4,31,0],[18,2,31,0],[19,2,33,0,"Object"],[19,8,33,0],[19,9,33,0,"defineProperty"],[19,23,33,0],[19,24,33,0,"exports"],[19,31,33,0],[20,4,33,0,"enumerable"],[20,14,33,0],[21,4,33,0,"get"],[21,7,33,0],[21,18,33,0,"get"],[21,19,33,0],[22,6,33,0],[22,13,33,0,"AuthProvider"],[22,25,33,0],[23,4,33,0],[24,2,33,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,2,69],[28,6,2,69,"_reactJsxDevRuntime"],[28,25,2,69],[28,28,2,69,"require"],[28,35,2,69],[28,36,2,69,"_dependencyMap"],[28,50,2,69],[29,2,4,0],[29,8,4,6,"BACKEND_URL"],[29,19,4,17],[29,22,4,20,"process"],[29,29,4,27],[29,30,4,28,"env"],[29,33,4,31],[29,34,4,32,"EXPO_PUBLIC_BACKEND_URL"],[29,57,4,55],[30,2,22,0],[30,8,22,6,"AuthContext"],[30,19,22,17],[30,35,22,20],[30,39,22,20,"createContext"],[30,45,22,33],[30,46,22,33,"createContext"],[30,59,22,33],[30,61,22,51],[31,4,23,2,"user"],[31,8,23,6],[31,10,23,8],[31,14,23,12],[32,4,24,2,"isLoading"],[32,13,24,11],[32,15,24,13],[32,19,24,17],[33,4,25,2,"isAuthenticated"],[33,19,25,17],[33,21,25,19],[33,26,25,24],[34,4,26,2,"login"],[34,9,26,7],[34,11,26,9],[34,17,26,9,"login"],[34,18,26,9],[34,23,26,21],[34,27,26,25],[35,4,27,2,"logout"],[35,10,27,8],[35,12,27,10],[35,18,27,10,"logout"],[35,19,27,10],[35,24,27,22],[35,25,27,23],[35,26,27,24],[36,4,28,2,"checkAuth"],[36,13,28,11],[36,15,28,13],[36,21,28,13,"checkAuth"],[36,22,28,13],[36,27,28,25],[36,28,28,26],[37,2,29,0],[37,3,29,1],[37,4,29,2],[38,2,31,7],[38,8,31,13,"useAuth"],[38,15,31,20],[38,18,31,23,"useAuth"],[38,19,31,23],[38,24,31,29],[38,28,31,29,"useContext"],[38,34,31,39],[38,35,31,39,"useContext"],[38,45,31,39],[38,47,31,40,"AuthContext"],[38,58,31,51],[38,59,31,52],[39,2,33,7],[39,8,33,13,"AuthProvider"],[39,20,33,66],[39,23,33,69,"AuthProvider"],[39,24,33,70],[40,4,33,72,"children"],[41,2,33,81],[41,3,33,82],[41,8,33,87],[42,4,34,2],[42,10,34,8],[42,11,34,9,"user"],[42,15,34,13],[42,17,34,15,"setUser"],[42,24,34,22],[42,25,34,23],[42,28,34,26],[42,32,34,26,"useState"],[42,38,34,34],[42,39,34,34,"useState"],[42,47,34,34],[42,49,34,48],[42,53,34,52],[42,54,34,53],[43,4,35,2],[43,10,35,8],[43,11,35,9,"isLoading"],[43,20,35,18],[43,22,35,20,"setIsLoading"],[43,34,35,32],[43,35,35,33],[43,38,35,36],[43,42,35,36,"useState"],[43,48,35,44],[43,49,35,44,"useState"],[43,57,35,44],[43,59,35,45],[43,63,35,49],[43,64,35,50],[44,4,37,2],[44,10,37,8,"checkAuth"],[44,19,37,17],[44,22,37,20],[44,26,37,20,"useCallback"],[44,32,37,31],[44,33,37,31,"useCallback"],[44,44,37,31],[44,46,37,32],[44,58,37,44],[45,6,38,4],[45,10,38,8],[46,8,39,6],[46,14,39,12,"storedToken"],[46,25,39,23],[46,28,39,26],[46,34,39,32,"AsyncStorage"],[46,46,39,44],[46,47,39,44,"default"],[46,54,39,44],[46,55,39,45,"getItem"],[46,62,39,52],[46,63,39,53],[46,78,39,68],[46,79,39,69],[47,8,40,6],[47,12,40,10],[47,13,40,11,"storedToken"],[47,24,40,22],[47,26,40,24],[48,10,41,8,"setUser"],[48,17,41,15],[48,18,41,16],[48,22,41,20],[48,23,41,21],[49,10,42,8,"setIsLoading"],[49,22,42,20],[49,23,42,21],[49,28,42,26],[49,29,42,27],[50,10,43,8],[51,8,44,6],[52,8,45,6],[52,14,45,12,"resp"],[52,18,45,16],[52,21,45,19],[52,27,45,25,"fetch"],[52,32,45,30],[52,33,45,31],[52,36,45,34,"BACKEND_URL"],[52,47,45,45],[52,61,45,59],[52,63,45,61],[53,10,46,8,"headers"],[53,17,46,15],[53,19,46,17],[54,12,46,19],[54,27,46,34],[54,29,46,36],[54,39,46,46,"storedToken"],[54,50,46,57],[55,10,46,60],[55,11,46,61],[56,10,47,8,"credentials"],[56,21,47,19],[56,23,47,21],[57,8,48,6],[57,9,48,7],[57,10,48,8],[58,8,49,6],[58,12,49,10,"resp"],[58,16,49,14],[58,17,49,15,"ok"],[58,19,49,17],[58,21,49,19],[59,10,50,8],[59,16,50,14,"userData"],[59,24,50,22],[59,27,50,25],[59,33,50,31,"resp"],[59,37,50,35],[59,38,50,36,"json"],[59,42,50,40],[59,43,50,41],[59,44,50,42],[60,10,51,8,"setUser"],[60,17,51,15],[60,18,51,16,"userData"],[60,26,51,24],[60,27,51,25],[61,8,52,6],[61,9,52,7],[61,15,52,13],[62,10,53,8,"setUser"],[62,17,53,15],[62,18,53,16],[62,22,53,20],[62,23,53,21],[63,10,54,8],[63,16,54,14,"AsyncStorage"],[63,28,54,26],[63,29,54,26,"default"],[63,36,54,26],[63,37,54,27,"removeItem"],[63,47,54,37],[63,48,54,38],[63,63,54,53],[63,64,54,54],[64,8,55,6],[65,6,56,4],[65,7,56,5],[65,8,56,6],[65,14,56,12],[66,8,57,6,"setUser"],[66,15,57,13],[66,16,57,14],[66,20,57,18],[66,21,57,19],[67,6,58,4],[67,7,58,5],[67,16,58,14],[68,8,59,6,"setIsLoading"],[68,20,59,18],[68,21,59,19],[68,26,59,24],[68,27,59,25],[69,6,60,4],[70,4,61,2],[70,5,61,3],[70,7,61,5],[70,9,61,7],[70,10,61,8],[71,4,63,2],[71,8,63,2,"useEffect"],[71,14,63,11],[71,15,63,11,"useEffect"],[71,24,63,11],[71,26,63,12],[71,32,63,18],[72,6,64,4,"checkAuth"],[72,15,64,13],[72,16,64,14],[72,17,64,15],[73,4,65,2],[73,5,65,3],[73,7,65,5],[73,8,65,6,"checkAuth"],[73,17,65,15],[73,18,65,16],[73,19,65,17],[74,4,67,2],[74,10,67,8,"login"],[74,15,67,13],[74,18,67,16],[74,24,67,23,"sessionId"],[74,33,67,40],[74,37,67,67],[75,6,68,4],[75,10,68,8],[76,8,69,6],[76,14,69,12,"resp"],[76,18,69,16],[76,21,69,19],[76,27,69,25,"fetch"],[76,32,69,30],[76,33,69,31],[76,36,69,34,"BACKEND_URL"],[76,47,69,45],[76,66,69,64],[76,68,69,66],[77,10,70,8,"method"],[77,16,70,14],[77,18,70,16],[77,24,70,22],[78,10,71,8,"headers"],[78,17,71,15],[78,19,71,17],[79,12,71,19],[79,26,71,33],[79,28,71,35],[80,10,71,54],[80,11,71,55],[81,10,72,8,"body"],[81,14,72,12],[81,16,72,14,"JSON"],[81,20,72,18],[81,21,72,19,"stringify"],[81,30,72,28],[81,31,72,29],[82,12,72,31,"session_id"],[82,22,72,41],[82,24,72,43,"sessionId"],[83,10,72,53],[83,11,72,54],[83,12,72,55],[84,10,73,8,"credentials"],[84,21,73,19],[84,23,73,21],[85,8,74,6],[85,9,74,7],[85,10,74,8],[86,8,75,6],[86,12,75,10],[86,13,75,11,"resp"],[86,17,75,15],[86,18,75,16,"ok"],[86,20,75,18],[86,22,75,20],[86,29,75,27],[86,33,75,31],[87,8,76,6],[87,14,76,12,"userData"],[87,22,76,20],[87,25,76,23],[87,31,76,29,"resp"],[87,35,76,33],[87,36,76,34,"json"],[87,40,76,38],[87,41,76,39],[87,42,76,40],[88,8,77,6],[89,8,78,6],[89,14,78,12,"cookies"],[89,21,78,19],[89,24,78,22,"resp"],[89,28,78,26],[89,29,78,27,"headers"],[89,36,78,34],[89,37,78,35,"get"],[89,40,78,38],[89,41,78,39],[89,53,78,51],[89,54,78,52],[90,8,79,6],[90,12,79,10,"cookies"],[90,19,79,17],[90,21,79,19],[91,10,80,8],[91,16,80,14,"tokenMatch"],[91,26,80,24],[91,29,80,27,"cookies"],[91,36,80,34],[91,37,80,35,"match"],[91,42,80,40],[91,43,80,41],[91,66,80,64],[91,67,80,65],[92,10,81,8],[92,14,81,12,"tokenMatch"],[92,24,81,22],[92,26,81,24],[93,12,82,10],[93,18,82,16,"AsyncStorage"],[93,30,82,28],[93,31,82,28,"default"],[93,38,82,28],[93,39,82,29,"setItem"],[93,46,82,36],[93,47,82,37],[93,62,82,52],[93,64,82,54,"tokenMatch"],[93,74,82,64],[93,75,82,65],[93,76,82,66],[93,77,82,67],[93,78,82,68],[94,10,83,8],[95,8,84,6],[96,8,85,6],[97,8,86,6],[97,12,86,10,"userData"],[97,20,86,18],[97,21,86,19,"session_token"],[97,34,86,32],[97,36,86,34],[98,10,87,8],[98,16,87,14,"AsyncStorage"],[98,28,87,26],[98,29,87,26,"default"],[98,36,87,26],[98,37,87,27,"setItem"],[98,44,87,34],[98,45,87,35],[98,60,87,50],[98,62,87,52,"userData"],[98,70,87,60],[98,71,87,61,"session_token"],[98,84,87,74],[98,85,87,75],[99,8,88,6],[100,8,89,6,"setUser"],[100,15,89,13],[100,16,89,14,"userData"],[100,24,89,22],[100,25,89,23],[101,8,90,6],[101,15,90,13,"userData"],[101,23,90,21],[102,6,91,4],[102,7,91,5],[102,8,91,6],[102,14,91,12],[103,8,92,6],[103,15,92,13],[103,19,92,17],[104,6,93,4],[105,4,94,2],[105,5,94,3],[106,4,96,2],[106,10,96,8,"logout"],[106,16,96,14],[106,19,96,17],[106,25,96,17,"logout"],[106,26,96,17],[106,31,96,29],[107,6,97,4],[107,10,97,8],[108,8,98,6],[108,14,98,12,"storedToken"],[108,25,98,23],[108,28,98,26],[108,34,98,32,"AsyncStorage"],[108,46,98,44],[108,47,98,44,"default"],[108,54,98,44],[108,55,98,45,"getItem"],[108,62,98,52],[108,63,98,53],[108,78,98,68],[108,79,98,69],[109,8,99,6],[109,14,99,12,"fetch"],[109,19,99,17],[109,20,99,18],[109,23,99,21,"BACKEND_URL"],[109,34,99,32],[109,52,99,50],[109,54,99,52],[110,10,100,8,"method"],[110,16,100,14],[110,18,100,16],[110,24,100,22],[111,10,101,8,"headers"],[111,17,101,15],[111,19,101,17,"storedToken"],[111,30,101,28],[111,33,101,31],[112,12,101,33],[112,27,101,48],[112,29,101,50],[112,39,101,60,"storedToken"],[112,50,101,71],[113,10,101,74],[113,11,101,75],[113,14,101,78],[113,15,101,79],[113,16,101,80],[114,10,102,8,"credentials"],[114,21,102,19],[114,23,102,21],[115,8,103,6],[115,9,103,7],[115,10,103,8],[116,6,104,4],[116,7,104,5],[116,8,104,6],[116,14,104,12],[116,15,104,14],[117,6,105,4],[117,12,105,10,"AsyncStorage"],[117,24,105,22],[117,25,105,22,"default"],[117,32,105,22],[117,33,105,23,"removeItem"],[117,43,105,33],[117,44,105,34],[117,59,105,49],[117,60,105,50],[118,6,106,4,"setUser"],[118,13,106,11],[118,14,106,12],[118,18,106,16],[118,19,106,17],[119,4,107,2],[119,5,107,3],[120,4,109,2],[120,24,110,4],[120,28,110,4,"_reactJsxDevRuntime"],[120,47,110,4],[120,48,110,4,"jsxDEV"],[120,54,110,4],[120,56,110,5,"AuthContext"],[120,67,110,16],[120,68,110,17,"Provider"],[120,76,110,25],[121,6,110,26,"value"],[121,11,110,31],[121,13,110,33],[122,8,110,35,"user"],[122,12,110,39],[123,8,110,41,"isLoading"],[123,17,110,50],[124,8,110,52,"isAuthenticated"],[124,23,110,67],[124,25,110,69],[124,26,110,70],[124,27,110,71,"user"],[124,31,110,75],[125,8,110,77,"login"],[125,13,110,82],[126,8,110,84,"logout"],[126,14,110,90],[127,8,110,92,"checkAuth"],[128,6,110,102],[128,7,110,104],[129,6,110,104,"children"],[129,14,110,104],[129,16,111,7,"children"],[130,4,111,15],[131,6,111,15,"fileName"],[131,14,111,15],[131,16,111,15,"_jsxFileName"],[131,28,111,15],[132,6,111,15,"lineNumber"],[132,16,111,15],[133,6,111,15,"columnNumber"],[133,18,111,15],[134,4,111,15],[134,11,112,26],[134,12,112,27],[135,2,114,0],[135,3,114,1],[136,0,114,2],[136,3]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.checkAuth","useAuth","AuthProvider","checkAuth","useEffect$argument_0","login","logout"],"mappings":"AAA;SCyB,gBD;UEC,cF;aGC,cH;uBIG,6BJ;qEKE;gCCI;GDwB;YEE;GFE;gBGE;GH2B;iBIE;GJW;CLO"},"hasCjsExports":false},"type":"js/module"}]}