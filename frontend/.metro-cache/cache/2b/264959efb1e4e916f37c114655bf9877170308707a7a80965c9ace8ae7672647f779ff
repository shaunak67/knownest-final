{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":91,"index":91}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":92},"end":{"line":2,"column":69,"index":161}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    login: async () => null,\n    logout: async () => {},\n    checkAuth: async () => {}\n  });\n  const useAuth = () => (0, _react.useContext)(AuthContext);\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const checkAuth = (0, _react.useCallback)(async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        if (!storedToken) {\n          setUser(null);\n          setIsLoading(false);\n          return;\n        }\n        const resp = await fetch(`${BACKEND_URL}/api/auth/me`, {\n          headers: {\n            'Authorization': `Bearer ${storedToken}`\n          },\n          credentials: 'include'\n        });\n        if (resp.ok) {\n          const userData = await resp.json();\n          setUser(userData);\n        } else {\n          setUser(null);\n          await AsyncStorage.default.removeItem('session_token');\n        }\n      } catch {\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, [checkAuth]);\n    const login = async sessionId => {\n      try {\n        const resp = await fetch(`${BACKEND_URL}/api/auth/session`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            session_id: sessionId\n          }),\n          credentials: 'include'\n        });\n        if (!resp.ok) return null;\n        const userData = await resp.json();\n\n        // Store session token from response body (primary method)\n        if (userData.session_token) {\n          await AsyncStorage.default.setItem('session_token', userData.session_token);\n        }\n\n        // Fallback: try from cookie header\n        if (!userData.session_token) {\n          const cookies = resp.headers.get('set-cookie');\n          if (cookies) {\n            const tokenMatch = cookies.match(/session_token=([^;]+)/);\n            if (tokenMatch) {\n              await AsyncStorage.default.setItem('session_token', tokenMatch[1]);\n            }\n          }\n        }\n        setUser(userData);\n        return userData;\n      } catch {\n        return null;\n      }\n    };\n    const logout = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        await fetch(`${BACKEND_URL}/api/auth/logout`, {\n          method: 'POST',\n          headers: storedToken ? {\n            'Authorization': `Bearer ${storedToken}`\n          } : {},\n          credentials: 'include'\n        });\n      } catch {/* ignore */}\n      await AsyncStorage.default.removeItem('session_token');\n      setUser(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        login,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 5\n    }, this);\n  };\n});","lineCount":140,"map":[[13,2,31,0,"Object"],[13,8,31,0],[13,9,31,0,"defineProperty"],[13,23,31,0],[13,24,31,0,"exports"],[13,31,31,0],[14,4,31,0,"enumerable"],[14,14,31,0],[15,4,31,0,"get"],[15,7,31,0],[15,18,31,0,"get"],[15,19,31,0],[16,6,31,0],[16,13,31,0,"useAuth"],[16,20,31,0],[17,4,31,0],[18,2,31,0],[19,2,33,0,"Object"],[19,8,33,0],[19,9,33,0,"defineProperty"],[19,23,33,0],[19,24,33,0,"exports"],[19,31,33,0],[20,4,33,0,"enumerable"],[20,14,33,0],[21,4,33,0,"get"],[21,7,33,0],[21,18,33,0,"get"],[21,19,33,0],[22,6,33,0],[22,13,33,0,"AuthProvider"],[22,25,33,0],[23,4,33,0],[24,2,33,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,2,69],[28,6,2,69,"_reactJsxDevRuntime"],[28,25,2,69],[28,28,2,69,"require"],[28,35,2,69],[28,36,2,69,"_dependencyMap"],[28,50,2,69],[29,2,4,0],[29,8,4,6,"BACKEND_URL"],[29,19,4,17],[29,22,4,20,"process"],[29,29,4,27],[29,30,4,28,"env"],[29,33,4,31],[29,34,4,32,"EXPO_PUBLIC_BACKEND_URL"],[29,57,4,55],[30,2,22,0],[30,8,22,6,"AuthContext"],[30,19,22,17],[30,35,22,20],[30,39,22,20,"createContext"],[30,45,22,33],[30,46,22,33,"createContext"],[30,59,22,33],[30,61,22,51],[31,4,23,2,"user"],[31,8,23,6],[31,10,23,8],[31,14,23,12],[32,4,24,2,"isLoading"],[32,13,24,11],[32,15,24,13],[32,19,24,17],[33,4,25,2,"isAuthenticated"],[33,19,25,17],[33,21,25,19],[33,26,25,24],[34,4,26,2,"login"],[34,9,26,7],[34,11,26,9],[34,17,26,9,"login"],[34,18,26,9],[34,23,26,21],[34,27,26,25],[35,4,27,2,"logout"],[35,10,27,8],[35,12,27,10],[35,18,27,10,"logout"],[35,19,27,10],[35,24,27,22],[35,25,27,23],[35,26,27,24],[36,4,28,2,"checkAuth"],[36,13,28,11],[36,15,28,13],[36,21,28,13,"checkAuth"],[36,22,28,13],[36,27,28,25],[36,28,28,26],[37,2,29,0],[37,3,29,1],[37,4,29,2],[38,2,31,7],[38,8,31,13,"useAuth"],[38,15,31,20],[38,18,31,23,"useAuth"],[38,19,31,23],[38,24,31,29],[38,28,31,29,"useContext"],[38,34,31,39],[38,35,31,39,"useContext"],[38,45,31,39],[38,47,31,40,"AuthContext"],[38,58,31,51],[38,59,31,52],[39,2,33,7],[39,8,33,13,"AuthProvider"],[39,20,33,66],[39,23,33,69,"AuthProvider"],[39,24,33,70],[40,4,33,72,"children"],[41,2,33,81],[41,3,33,82],[41,8,33,87],[42,4,34,2],[42,10,34,8],[42,11,34,9,"user"],[42,15,34,13],[42,17,34,15,"setUser"],[42,24,34,22],[42,25,34,23],[42,28,34,26],[42,32,34,26,"useState"],[42,38,34,34],[42,39,34,34,"useState"],[42,47,34,34],[42,49,34,48],[42,53,34,52],[42,54,34,53],[43,4,35,2],[43,10,35,8],[43,11,35,9,"isLoading"],[43,20,35,18],[43,22,35,20,"setIsLoading"],[43,34,35,32],[43,35,35,33],[43,38,35,36],[43,42,35,36,"useState"],[43,48,35,44],[43,49,35,44,"useState"],[43,57,35,44],[43,59,35,45],[43,63,35,49],[43,64,35,50],[44,4,37,2],[44,10,37,8,"checkAuth"],[44,19,37,17],[44,22,37,20],[44,26,37,20,"useCallback"],[44,32,37,31],[44,33,37,31,"useCallback"],[44,44,37,31],[44,46,37,32],[44,58,37,44],[45,6,38,4],[45,10,38,8],[46,8,39,6],[46,14,39,12,"storedToken"],[46,25,39,23],[46,28,39,26],[46,34,39,32,"AsyncStorage"],[46,46,39,44],[46,47,39,44,"default"],[46,54,39,44],[46,55,39,45,"getItem"],[46,62,39,52],[46,63,39,53],[46,78,39,68],[46,79,39,69],[47,8,40,6],[47,12,40,10],[47,13,40,11,"storedToken"],[47,24,40,22],[47,26,40,24],[48,10,41,8,"setUser"],[48,17,41,15],[48,18,41,16],[48,22,41,20],[48,23,41,21],[49,10,42,8,"setIsLoading"],[49,22,42,20],[49,23,42,21],[49,28,42,26],[49,29,42,27],[50,10,43,8],[51,8,44,6],[52,8,45,6],[52,14,45,12,"resp"],[52,18,45,16],[52,21,45,19],[52,27,45,25,"fetch"],[52,32,45,30],[52,33,45,31],[52,36,45,34,"BACKEND_URL"],[52,47,45,45],[52,61,45,59],[52,63,45,61],[53,10,46,8,"headers"],[53,17,46,15],[53,19,46,17],[54,12,46,19],[54,27,46,34],[54,29,46,36],[54,39,46,46,"storedToken"],[54,50,46,57],[55,10,46,60],[55,11,46,61],[56,10,47,8,"credentials"],[56,21,47,19],[56,23,47,21],[57,8,48,6],[57,9,48,7],[57,10,48,8],[58,8,49,6],[58,12,49,10,"resp"],[58,16,49,14],[58,17,49,15,"ok"],[58,19,49,17],[58,21,49,19],[59,10,50,8],[59,16,50,14,"userData"],[59,24,50,22],[59,27,50,25],[59,33,50,31,"resp"],[59,37,50,35],[59,38,50,36,"json"],[59,42,50,40],[59,43,50,41],[59,44,50,42],[60,10,51,8,"setUser"],[60,17,51,15],[60,18,51,16,"userData"],[60,26,51,24],[60,27,51,25],[61,8,52,6],[61,9,52,7],[61,15,52,13],[62,10,53,8,"setUser"],[62,17,53,15],[62,18,53,16],[62,22,53,20],[62,23,53,21],[63,10,54,8],[63,16,54,14,"AsyncStorage"],[63,28,54,26],[63,29,54,26,"default"],[63,36,54,26],[63,37,54,27,"removeItem"],[63,47,54,37],[63,48,54,38],[63,63,54,53],[63,64,54,54],[64,8,55,6],[65,6,56,4],[65,7,56,5],[65,8,56,6],[65,14,56,12],[66,8,57,6,"setUser"],[66,15,57,13],[66,16,57,14],[66,20,57,18],[66,21,57,19],[67,6,58,4],[67,7,58,5],[67,16,58,14],[68,8,59,6,"setIsLoading"],[68,20,59,18],[68,21,59,19],[68,26,59,24],[68,27,59,25],[69,6,60,4],[70,4,61,2],[70,5,61,3],[70,7,61,5],[70,9,61,7],[70,10,61,8],[71,4,63,2],[71,8,63,2,"useEffect"],[71,14,63,11],[71,15,63,11,"useEffect"],[71,24,63,11],[71,26,63,12],[71,32,63,18],[72,6,64,4,"checkAuth"],[72,15,64,13],[72,16,64,14],[72,17,64,15],[73,4,65,2],[73,5,65,3],[73,7,65,5],[73,8,65,6,"checkAuth"],[73,17,65,15],[73,18,65,16],[73,19,65,17],[74,4,67,2],[74,10,67,8,"login"],[74,15,67,13],[74,18,67,16],[74,24,67,23,"sessionId"],[74,33,67,40],[74,37,67,67],[75,6,68,4],[75,10,68,8],[76,8,69,6],[76,14,69,12,"resp"],[76,18,69,16],[76,21,69,19],[76,27,69,25,"fetch"],[76,32,69,30],[76,33,69,31],[76,36,69,34,"BACKEND_URL"],[76,47,69,45],[76,66,69,64],[76,68,69,66],[77,10,70,8,"method"],[77,16,70,14],[77,18,70,16],[77,24,70,22],[78,10,71,8,"headers"],[78,17,71,15],[78,19,71,17],[79,12,71,19],[79,26,71,33],[79,28,71,35],[80,10,71,54],[80,11,71,55],[81,10,72,8,"body"],[81,14,72,12],[81,16,72,14,"JSON"],[81,20,72,18],[81,21,72,19,"stringify"],[81,30,72,28],[81,31,72,29],[82,12,72,31,"session_id"],[82,22,72,41],[82,24,72,43,"sessionId"],[83,10,72,53],[83,11,72,54],[83,12,72,55],[84,10,73,8,"credentials"],[84,21,73,19],[84,23,73,21],[85,8,74,6],[85,9,74,7],[85,10,74,8],[86,8,75,6],[86,12,75,10],[86,13,75,11,"resp"],[86,17,75,15],[86,18,75,16,"ok"],[86,20,75,18],[86,22,75,20],[86,29,75,27],[86,33,75,31],[87,8,76,6],[87,14,76,12,"userData"],[87,22,76,20],[87,25,76,23],[87,31,76,29,"resp"],[87,35,76,33],[87,36,76,34,"json"],[87,40,76,38],[87,41,76,39],[87,42,76,40],[89,8,78,6],[90,8,79,6],[90,12,79,10,"userData"],[90,20,79,18],[90,21,79,19,"session_token"],[90,34,79,32],[90,36,79,34],[91,10,80,8],[91,16,80,14,"AsyncStorage"],[91,28,80,26],[91,29,80,26,"default"],[91,36,80,26],[91,37,80,27,"setItem"],[91,44,80,34],[91,45,80,35],[91,60,80,50],[91,62,80,52,"userData"],[91,70,80,60],[91,71,80,61,"session_token"],[91,84,80,74],[91,85,80,75],[92,8,81,6],[94,8,83,6],[95,8,84,6],[95,12,84,10],[95,13,84,11,"userData"],[95,21,84,19],[95,22,84,20,"session_token"],[95,35,84,33],[95,37,84,35],[96,10,85,8],[96,16,85,14,"cookies"],[96,23,85,21],[96,26,85,24,"resp"],[96,30,85,28],[96,31,85,29,"headers"],[96,38,85,36],[96,39,85,37,"get"],[96,42,85,40],[96,43,85,41],[96,55,85,53],[96,56,85,54],[97,10,86,8],[97,14,86,12,"cookies"],[97,21,86,19],[97,23,86,21],[98,12,87,10],[98,18,87,16,"tokenMatch"],[98,28,87,26],[98,31,87,29,"cookies"],[98,38,87,36],[98,39,87,37,"match"],[98,44,87,42],[98,45,87,43],[98,68,87,66],[98,69,87,67],[99,12,88,10],[99,16,88,14,"tokenMatch"],[99,26,88,24],[99,28,88,26],[100,14,89,12],[100,20,89,18,"AsyncStorage"],[100,32,89,30],[100,33,89,30,"default"],[100,40,89,30],[100,41,89,31,"setItem"],[100,48,89,38],[100,49,89,39],[100,64,89,54],[100,66,89,56,"tokenMatch"],[100,76,89,66],[100,77,89,67],[100,78,89,68],[100,79,89,69],[100,80,89,70],[101,12,90,10],[102,10,91,8],[103,8,92,6],[104,8,94,6,"setUser"],[104,15,94,13],[104,16,94,14,"userData"],[104,24,94,22],[104,25,94,23],[105,8,95,6],[105,15,95,13,"userData"],[105,23,95,21],[106,6,96,4],[106,7,96,5],[106,8,96,6],[106,14,96,12],[107,8,97,6],[107,15,97,13],[107,19,97,17],[108,6,98,4],[109,4,99,2],[109,5,99,3],[110,4,101,2],[110,10,101,8,"logout"],[110,16,101,14],[110,19,101,17],[110,25,101,17,"logout"],[110,26,101,17],[110,31,101,29],[111,6,102,4],[111,10,102,8],[112,8,103,6],[112,14,103,12,"storedToken"],[112,25,103,23],[112,28,103,26],[112,34,103,32,"AsyncStorage"],[112,46,103,44],[112,47,103,44,"default"],[112,54,103,44],[112,55,103,45,"getItem"],[112,62,103,52],[112,63,103,53],[112,78,103,68],[112,79,103,69],[113,8,104,6],[113,14,104,12,"fetch"],[113,19,104,17],[113,20,104,18],[113,23,104,21,"BACKEND_URL"],[113,34,104,32],[113,52,104,50],[113,54,104,52],[114,10,105,8,"method"],[114,16,105,14],[114,18,105,16],[114,24,105,22],[115,10,106,8,"headers"],[115,17,106,15],[115,19,106,17,"storedToken"],[115,30,106,28],[115,33,106,31],[116,12,106,33],[116,27,106,48],[116,29,106,50],[116,39,106,60,"storedToken"],[116,50,106,71],[117,10,106,74],[117,11,106,75],[117,14,106,78],[117,15,106,79],[117,16,106,80],[118,10,107,8,"credentials"],[118,21,107,19],[118,23,107,21],[119,8,108,6],[119,9,108,7],[119,10,108,8],[120,6,109,4],[120,7,109,5],[120,8,109,6],[120,14,109,12],[120,15,109,14],[121,6,110,4],[121,12,110,10,"AsyncStorage"],[121,24,110,22],[121,25,110,22,"default"],[121,32,110,22],[121,33,110,23,"removeItem"],[121,43,110,33],[121,44,110,34],[121,59,110,49],[121,60,110,50],[122,6,111,4,"setUser"],[122,13,111,11],[122,14,111,12],[122,18,111,16],[122,19,111,17],[123,4,112,2],[123,5,112,3],[124,4,114,2],[124,24,115,4],[124,28,115,4,"_reactJsxDevRuntime"],[124,47,115,4],[124,48,115,4,"jsxDEV"],[124,54,115,4],[124,56,115,5,"AuthContext"],[124,67,115,16],[124,68,115,17,"Provider"],[124,76,115,25],[125,6,115,26,"value"],[125,11,115,31],[125,13,115,33],[126,8,115,35,"user"],[126,12,115,39],[127,8,115,41,"isLoading"],[127,17,115,50],[128,8,115,52,"isAuthenticated"],[128,23,115,67],[128,25,115,69],[128,26,115,70],[128,27,115,71,"user"],[128,31,115,75],[129,8,115,77,"login"],[129,13,115,82],[130,8,115,84,"logout"],[130,14,115,90],[131,8,115,92,"checkAuth"],[132,6,115,102],[132,7,115,104],[133,6,115,104,"children"],[133,14,115,104],[133,16,116,7,"children"],[134,4,116,15],[135,6,116,15,"fileName"],[135,14,116,15],[135,16,116,15,"_jsxFileName"],[135,28,116,15],[136,6,116,15,"lineNumber"],[136,16,116,15],[137,6,116,15,"columnNumber"],[137,18,116,15],[138,4,116,15],[138,11,117,26],[138,12,117,27],[139,2,119,0],[139,3,119,1],[140,0,119,2],[140,3]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.checkAuth","useAuth","AuthProvider","checkAuth","useEffect$argument_0","login","logout"],"mappings":"AAA;SCyB,gBD;UEC,cF;aGC,cH;uBIG,6BJ;qEKE;gCCI;GDwB;YEE;GFE;gBGE;GHgC;iBIE;GJW;CLO"},"hasCjsExports":false},"type":"js/module"}]}