{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":91,"index":91}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":92},"end":{"line":2,"column":69,"index":161}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _react = require(_dependencyMap[1], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[2], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const BACKEND_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    login: async () => null,\n    logout: async () => {},\n    checkAuth: async () => {}\n  });\n  const useAuth = () => {\n    _s();\n    return (0, _react.useContext)(AuthContext);\n  };\n  _s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n  const AuthProvider = ({\n    children\n  }) => {\n    _s2();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const checkAuth = (0, _react.useCallback)(async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        if (!storedToken) {\n          setUser(null);\n          setIsLoading(false);\n          return;\n        }\n        const resp = await fetch(`${BACKEND_URL}/api/auth/me`, {\n          headers: {\n            'Authorization': `Bearer ${storedToken}`\n          },\n          credentials: 'include'\n        });\n        if (resp.ok) {\n          const userData = await resp.json();\n          setUser(userData);\n        } else {\n          setUser(null);\n          await AsyncStorage.default.removeItem('session_token');\n        }\n      } catch {\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, [checkAuth]);\n    const login = async sessionId => {\n      try {\n        const resp = await fetch(`${BACKEND_URL}/api/auth/session`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            session_id: sessionId\n          }),\n          credentials: 'include'\n        });\n        if (!resp.ok) return null;\n        const userData = await resp.json();\n        // Store session token from response headers or extract from cookie\n        const cookies = resp.headers.get('set-cookie');\n        if (cookies) {\n          const tokenMatch = cookies.match(/session_token=([^;]+)/);\n          if (tokenMatch) {\n            await AsyncStorage.default.setItem('session_token', tokenMatch[1]);\n          }\n        }\n        // Also try storing from the session_id exchange\n        if (userData.session_token) {\n          await AsyncStorage.default.setItem('session_token', userData.session_token);\n        }\n        setUser(userData);\n        return userData;\n      } catch {\n        return null;\n      }\n    };\n    const logout = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        await fetch(`${BACKEND_URL}/api/auth/logout`, {\n          method: 'POST',\n          headers: storedToken ? {\n            'Authorization': `Bearer ${storedToken}`\n          } : {},\n          credentials: 'include'\n        });\n      } catch {/* ignore */}\n      await AsyncStorage.default.removeItem('session_token');\n      setUser(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        login,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 5\n    }, this);\n  };\n  _s2(AuthProvider, \"UXO0MW8OFT5jrQH1+T8ZTvU2qWA=\");\n  _c = AuthProvider;\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":148,"map":[[15,2,31,0,"Object"],[15,8,31,0],[15,9,31,0,"defineProperty"],[15,23,31,0],[15,24,31,0,"exports"],[15,31,31,0],[16,4,31,0,"enumerable"],[16,14,31,0],[17,4,31,0,"get"],[17,7,31,0],[17,18,31,0,"get"],[17,19,31,0],[18,6,31,0],[18,13,31,0,"useAuth"],[18,20,31,0],[19,4,31,0],[20,2,31,0],[21,2,33,0,"Object"],[21,8,33,0],[21,9,33,0,"defineProperty"],[21,23,33,0],[21,24,33,0,"exports"],[21,31,33,0],[22,4,33,0,"enumerable"],[22,14,33,0],[23,4,33,0,"get"],[23,7,33,0],[23,18,33,0,"get"],[23,19,33,0],[24,6,33,0],[24,13,33,0,"AuthProvider"],[24,25,33,0],[25,4,33,0],[26,2,33,0],[27,2,114,2],[27,6,114,2,"_expoVirtualEnv"],[27,21,114,2],[27,24,114,2,"require"],[27,31,114,2],[27,32,114,2,"_dependencyMap"],[27,46,114,2],[28,2,1,0],[28,6,1,0,"_react"],[28,12,1,0],[28,15,1,0,"require"],[28,22,1,0],[28,23,1,0,"_dependencyMap"],[28,37,1,0],[29,2,2,0],[29,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[29,42,2,0],[29,45,2,0,"require"],[29,52,2,0],[29,53,2,0,"_dependencyMap"],[29,67,2,0],[30,2,2,0],[30,6,2,0,"AsyncStorage"],[30,18,2,0],[30,21,2,0,"_interopDefault"],[30,36,2,0],[30,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[30,73,2,0],[31,2,2,69],[31,6,2,69,"_reactJsxDevRuntime"],[31,25,2,69],[31,28,2,69,"require"],[31,35,2,69],[31,36,2,69,"_dependencyMap"],[31,50,2,69],[32,2,4,0],[32,8,4,6,"BACKEND_URL"],[32,19,4,17],[32,22,4,17,"_expoVirtualEnv"],[32,37,4,17],[32,38,4,17,"env"],[32,41,4,17],[32,42,4,17,"EXPO_PUBLIC_BACKEND_URL"],[32,65,4,55],[33,2,22,0],[33,8,22,6,"AuthContext"],[33,19,22,17],[33,35,22,20],[33,39,22,20,"createContext"],[33,45,22,33],[33,46,22,33,"createContext"],[33,59,22,33],[33,61,22,51],[34,4,23,2,"user"],[34,8,23,6],[34,10,23,8],[34,14,23,12],[35,4,24,2,"isLoading"],[35,13,24,11],[35,15,24,13],[35,19,24,17],[36,4,25,2,"isAuthenticated"],[36,19,25,17],[36,21,25,19],[36,26,25,24],[37,4,26,2,"login"],[37,9,26,7],[37,11,26,9],[37,17,26,9,"login"],[37,18,26,9],[37,23,26,21],[37,27,26,25],[38,4,27,2,"logout"],[38,10,27,8],[38,12,27,10],[38,18,27,10,"logout"],[38,19,27,10],[38,24,27,22],[38,25,27,23],[38,26,27,24],[39,4,28,2,"checkAuth"],[39,13,28,11],[39,15,28,13],[39,21,28,13,"checkAuth"],[39,22,28,13],[39,27,28,25],[39,28,28,26],[40,2,29,0],[40,3,29,1],[40,4,29,2],[41,2,31,7],[41,8,31,13,"useAuth"],[41,15,31,20],[41,18,31,23,"useAuth"],[41,19,31,23],[42,4,31,23,"_s"],[42,6,31,23],[43,4,31,23],[43,11,31,29],[43,15,31,29,"useContext"],[43,21,31,39],[43,22,31,39,"useContext"],[43,32,31,39],[43,34,31,40,"AuthContext"],[43,45,31,51],[43,46,31,52],[44,2,31,52],[45,2,31,53,"_s"],[45,4,31,53],[45,5,31,13,"useAuth"],[45,12,31,20],[46,2,33,7],[46,8,33,13,"AuthProvider"],[46,20,33,66],[46,23,33,69,"AuthProvider"],[46,24,33,70],[47,4,33,72,"children"],[48,2,33,81],[48,3,33,82],[48,8,33,87],[49,4,33,87,"_s2"],[49,7,33,87],[50,4,34,2],[50,10,34,8],[50,11,34,9,"user"],[50,15,34,13],[50,17,34,15,"setUser"],[50,24,34,22],[50,25,34,23],[50,28,34,26],[50,32,34,26,"useState"],[50,38,34,34],[50,39,34,34,"useState"],[50,47,34,34],[50,49,34,48],[50,53,34,52],[50,54,34,53],[51,4,35,2],[51,10,35,8],[51,11,35,9,"isLoading"],[51,20,35,18],[51,22,35,20,"setIsLoading"],[51,34,35,32],[51,35,35,33],[51,38,35,36],[51,42,35,36,"useState"],[51,48,35,44],[51,49,35,44,"useState"],[51,57,35,44],[51,59,35,45],[51,63,35,49],[51,64,35,50],[52,4,37,2],[52,10,37,8,"checkAuth"],[52,19,37,17],[52,22,37,20],[52,26,37,20,"useCallback"],[52,32,37,31],[52,33,37,31,"useCallback"],[52,44,37,31],[52,46,37,32],[52,58,37,44],[53,6,38,4],[53,10,38,8],[54,8,39,6],[54,14,39,12,"storedToken"],[54,25,39,23],[54,28,39,26],[54,34,39,32,"AsyncStorage"],[54,46,39,44],[54,47,39,44,"default"],[54,54,39,44],[54,55,39,45,"getItem"],[54,62,39,52],[54,63,39,53],[54,78,39,68],[54,79,39,69],[55,8,40,6],[55,12,40,10],[55,13,40,11,"storedToken"],[55,24,40,22],[55,26,40,24],[56,10,41,8,"setUser"],[56,17,41,15],[56,18,41,16],[56,22,41,20],[56,23,41,21],[57,10,42,8,"setIsLoading"],[57,22,42,20],[57,23,42,21],[57,28,42,26],[57,29,42,27],[58,10,43,8],[59,8,44,6],[60,8,45,6],[60,14,45,12,"resp"],[60,18,45,16],[60,21,45,19],[60,27,45,25,"fetch"],[60,32,45,30],[60,33,45,31],[60,36,45,34,"BACKEND_URL"],[60,47,45,45],[60,61,45,59],[60,63,45,61],[61,10,46,8,"headers"],[61,17,46,15],[61,19,46,17],[62,12,46,19],[62,27,46,34],[62,29,46,36],[62,39,46,46,"storedToken"],[62,50,46,57],[63,10,46,60],[63,11,46,61],[64,10,47,8,"credentials"],[64,21,47,19],[64,23,47,21],[65,8,48,6],[65,9,48,7],[65,10,48,8],[66,8,49,6],[66,12,49,10,"resp"],[66,16,49,14],[66,17,49,15,"ok"],[66,19,49,17],[66,21,49,19],[67,10,50,8],[67,16,50,14,"userData"],[67,24,50,22],[67,27,50,25],[67,33,50,31,"resp"],[67,37,50,35],[67,38,50,36,"json"],[67,42,50,40],[67,43,50,41],[67,44,50,42],[68,10,51,8,"setUser"],[68,17,51,15],[68,18,51,16,"userData"],[68,26,51,24],[68,27,51,25],[69,8,52,6],[69,9,52,7],[69,15,52,13],[70,10,53,8,"setUser"],[70,17,53,15],[70,18,53,16],[70,22,53,20],[70,23,53,21],[71,10,54,8],[71,16,54,14,"AsyncStorage"],[71,28,54,26],[71,29,54,26,"default"],[71,36,54,26],[71,37,54,27,"removeItem"],[71,47,54,37],[71,48,54,38],[71,63,54,53],[71,64,54,54],[72,8,55,6],[73,6,56,4],[73,7,56,5],[73,8,56,6],[73,14,56,12],[74,8,57,6,"setUser"],[74,15,57,13],[74,16,57,14],[74,20,57,18],[74,21,57,19],[75,6,58,4],[75,7,58,5],[75,16,58,14],[76,8,59,6,"setIsLoading"],[76,20,59,18],[76,21,59,19],[76,26,59,24],[76,27,59,25],[77,6,60,4],[78,4,61,2],[78,5,61,3],[78,7,61,5],[78,9,61,7],[78,10,61,8],[79,4,63,2],[79,8,63,2,"useEffect"],[79,14,63,11],[79,15,63,11,"useEffect"],[79,24,63,11],[79,26,63,12],[79,32,63,18],[80,6,64,4,"checkAuth"],[80,15,64,13],[80,16,64,14],[80,17,64,15],[81,4,65,2],[81,5,65,3],[81,7,65,5],[81,8,65,6,"checkAuth"],[81,17,65,15],[81,18,65,16],[81,19,65,17],[82,4,67,2],[82,10,67,8,"login"],[82,15,67,13],[82,18,67,16],[82,24,67,23,"sessionId"],[82,33,67,40],[82,37,67,67],[83,6,68,4],[83,10,68,8],[84,8,69,6],[84,14,69,12,"resp"],[84,18,69,16],[84,21,69,19],[84,27,69,25,"fetch"],[84,32,69,30],[84,33,69,31],[84,36,69,34,"BACKEND_URL"],[84,47,69,45],[84,66,69,64],[84,68,69,66],[85,10,70,8,"method"],[85,16,70,14],[85,18,70,16],[85,24,70,22],[86,10,71,8,"headers"],[86,17,71,15],[86,19,71,17],[87,12,71,19],[87,26,71,33],[87,28,71,35],[88,10,71,54],[88,11,71,55],[89,10,72,8,"body"],[89,14,72,12],[89,16,72,14,"JSON"],[89,20,72,18],[89,21,72,19,"stringify"],[89,30,72,28],[89,31,72,29],[90,12,72,31,"session_id"],[90,22,72,41],[90,24,72,43,"sessionId"],[91,10,72,53],[91,11,72,54],[91,12,72,55],[92,10,73,8,"credentials"],[92,21,73,19],[92,23,73,21],[93,8,74,6],[93,9,74,7],[93,10,74,8],[94,8,75,6],[94,12,75,10],[94,13,75,11,"resp"],[94,17,75,15],[94,18,75,16,"ok"],[94,20,75,18],[94,22,75,20],[94,29,75,27],[94,33,75,31],[95,8,76,6],[95,14,76,12,"userData"],[95,22,76,20],[95,25,76,23],[95,31,76,29,"resp"],[95,35,76,33],[95,36,76,34,"json"],[95,40,76,38],[95,41,76,39],[95,42,76,40],[96,8,77,6],[97,8,78,6],[97,14,78,12,"cookies"],[97,21,78,19],[97,24,78,22,"resp"],[97,28,78,26],[97,29,78,27,"headers"],[97,36,78,34],[97,37,78,35,"get"],[97,40,78,38],[97,41,78,39],[97,53,78,51],[97,54,78,52],[98,8,79,6],[98,12,79,10,"cookies"],[98,19,79,17],[98,21,79,19],[99,10,80,8],[99,16,80,14,"tokenMatch"],[99,26,80,24],[99,29,80,27,"cookies"],[99,36,80,34],[99,37,80,35,"match"],[99,42,80,40],[99,43,80,41],[99,66,80,64],[99,67,80,65],[100,10,81,8],[100,14,81,12,"tokenMatch"],[100,24,81,22],[100,26,81,24],[101,12,82,10],[101,18,82,16,"AsyncStorage"],[101,30,82,28],[101,31,82,28,"default"],[101,38,82,28],[101,39,82,29,"setItem"],[101,46,82,36],[101,47,82,37],[101,62,82,52],[101,64,82,54,"tokenMatch"],[101,74,82,64],[101,75,82,65],[101,76,82,66],[101,77,82,67],[101,78,82,68],[102,10,83,8],[103,8,84,6],[104,8,85,6],[105,8,86,6],[105,12,86,10,"userData"],[105,20,86,18],[105,21,86,19,"session_token"],[105,34,86,32],[105,36,86,34],[106,10,87,8],[106,16,87,14,"AsyncStorage"],[106,28,87,26],[106,29,87,26,"default"],[106,36,87,26],[106,37,87,27,"setItem"],[106,44,87,34],[106,45,87,35],[106,60,87,50],[106,62,87,52,"userData"],[106,70,87,60],[106,71,87,61,"session_token"],[106,84,87,74],[106,85,87,75],[107,8,88,6],[108,8,89,6,"setUser"],[108,15,89,13],[108,16,89,14,"userData"],[108,24,89,22],[108,25,89,23],[109,8,90,6],[109,15,90,13,"userData"],[109,23,90,21],[110,6,91,4],[110,7,91,5],[110,8,91,6],[110,14,91,12],[111,8,92,6],[111,15,92,13],[111,19,92,17],[112,6,93,4],[113,4,94,2],[113,5,94,3],[114,4,96,2],[114,10,96,8,"logout"],[114,16,96,14],[114,19,96,17],[114,25,96,17,"logout"],[114,26,96,17],[114,31,96,29],[115,6,97,4],[115,10,97,8],[116,8,98,6],[116,14,98,12,"storedToken"],[116,25,98,23],[116,28,98,26],[116,34,98,32,"AsyncStorage"],[116,46,98,44],[116,47,98,44,"default"],[116,54,98,44],[116,55,98,45,"getItem"],[116,62,98,52],[116,63,98,53],[116,78,98,68],[116,79,98,69],[117,8,99,6],[117,14,99,12,"fetch"],[117,19,99,17],[117,20,99,18],[117,23,99,21,"BACKEND_URL"],[117,34,99,32],[117,52,99,50],[117,54,99,52],[118,10,100,8,"method"],[118,16,100,14],[118,18,100,16],[118,24,100,22],[119,10,101,8,"headers"],[119,17,101,15],[119,19,101,17,"storedToken"],[119,30,101,28],[119,33,101,31],[120,12,101,33],[120,27,101,48],[120,29,101,50],[120,39,101,60,"storedToken"],[120,50,101,71],[121,10,101,74],[121,11,101,75],[121,14,101,78],[121,15,101,79],[121,16,101,80],[122,10,102,8,"credentials"],[122,21,102,19],[122,23,102,21],[123,8,103,6],[123,9,103,7],[123,10,103,8],[124,6,104,4],[124,7,104,5],[124,8,104,6],[124,14,104,12],[124,15,104,14],[125,6,105,4],[125,12,105,10,"AsyncStorage"],[125,24,105,22],[125,25,105,22,"default"],[125,32,105,22],[125,33,105,23,"removeItem"],[125,43,105,33],[125,44,105,34],[125,59,105,49],[125,60,105,50],[126,6,106,4,"setUser"],[126,13,106,11],[126,14,106,12],[126,18,106,16],[126,19,106,17],[127,4,107,2],[127,5,107,3],[128,4,109,2],[128,24,110,4],[128,28,110,4,"_reactJsxDevRuntime"],[128,47,110,4],[128,48,110,4,"jsxDEV"],[128,54,110,4],[128,56,110,5,"AuthContext"],[128,67,110,16],[128,68,110,17,"Provider"],[128,76,110,25],[129,6,110,26,"value"],[129,11,110,31],[129,13,110,33],[130,8,110,35,"user"],[130,12,110,39],[131,8,110,41,"isLoading"],[131,17,110,50],[132,8,110,52,"isAuthenticated"],[132,23,110,67],[132,25,110,69],[132,26,110,70],[132,27,110,71,"user"],[132,31,110,75],[133,8,110,77,"login"],[133,13,110,82],[134,8,110,84,"logout"],[134,14,110,90],[135,8,110,92,"checkAuth"],[136,6,110,102],[136,7,110,104],[137,6,110,104,"children"],[137,14,110,104],[137,16,111,7,"children"],[138,4,111,15],[139,6,111,15,"fileName"],[139,14,111,15],[139,16,111,15,"_jsxFileName"],[139,28,111,15],[140,6,111,15,"lineNumber"],[140,16,111,15],[141,6,111,15,"columnNumber"],[141,18,111,15],[142,4,111,15],[142,11,112,26],[142,12,112,27],[143,2,114,0],[143,3,114,1],[144,2,114,2,"_s2"],[144,5,114,2],[144,6,33,13,"AuthProvider"],[144,18,33,66],[145,2,33,66,"_c"],[145,4,33,66],[145,7,33,13,"AuthProvider"],[145,19,33,66],[146,2,33,66],[146,6,33,66,"_c"],[146,8,33,66],[147,2,33,66,"$RefreshReg$"],[147,14,33,66],[147,15,33,66,"_c"],[147,17,33,66],[148,0,33,66],[148,3]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.checkAuth","useAuth","AuthProvider","checkAuth","useEffect$argument_0","login","logout"],"mappings":"AAA;SCyB,gBD;UEC,cF;aGC,cH;uBIG,6BJ;qEKE;gCCI;GDwB;YEE;GFE;gBGE;GH2B;iBIE;GJW;CLO"},"hasCjsExports":false},"type":"js/module"}]}