{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":91,"index":91}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":92},"end":{"line":2,"column":69,"index":161}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _react = require(_dependencyMap[1], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[2], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const BACKEND_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)({\n    user: null,\n    isLoading: true,\n    isAuthenticated: false,\n    login: async () => null,\n    logout: async () => {},\n    checkAuth: async () => {}\n  });\n  const useAuth = () => {\n    _s();\n    return (0, _react.useContext)(AuthContext);\n  };\n  _s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n  const AuthProvider = ({\n    children\n  }) => {\n    _s2();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const checkAuth = (0, _react.useCallback)(async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        if (!storedToken) {\n          setUser(null);\n          setIsLoading(false);\n          return;\n        }\n        const resp = await fetch(`${BACKEND_URL}/api/auth/me`, {\n          headers: {\n            'Authorization': `Bearer ${storedToken}`\n          },\n          credentials: 'include'\n        });\n        if (resp.ok) {\n          const userData = await resp.json();\n          setUser(userData);\n        } else {\n          setUser(null);\n          await AsyncStorage.default.removeItem('session_token');\n        }\n      } catch {\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, [checkAuth]);\n    const login = async sessionId => {\n      try {\n        const resp = await fetch(`${BACKEND_URL}/api/auth/session`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            session_id: sessionId\n          }),\n          credentials: 'include'\n        });\n        if (!resp.ok) return null;\n        const userData = await resp.json();\n\n        // Store session token from response body (primary method)\n        if (userData.session_token) {\n          await AsyncStorage.default.setItem('session_token', userData.session_token);\n        }\n\n        // Fallback: try from cookie header\n        if (!userData.session_token) {\n          const cookies = resp.headers.get('set-cookie');\n          if (cookies) {\n            const tokenMatch = cookies.match(/session_token=([^;]+)/);\n            if (tokenMatch) {\n              await AsyncStorage.default.setItem('session_token', tokenMatch[1]);\n            }\n          }\n        }\n        setUser(userData);\n        return userData;\n      } catch {\n        return null;\n      }\n    };\n    const logout = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('session_token');\n        await fetch(`${BACKEND_URL}/api/auth/logout`, {\n          method: 'POST',\n          headers: storedToken ? {\n            'Authorization': `Bearer ${storedToken}`\n          } : {},\n          credentials: 'include'\n        });\n      } catch {/* ignore */}\n      await AsyncStorage.default.removeItem('session_token');\n      setUser(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        login,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 5\n    }, this);\n  };\n  _s2(AuthProvider, \"UXO0MW8OFT5jrQH1+T8ZTvU2qWA=\");\n  _c = AuthProvider;\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":152,"map":[[15,2,31,0,"Object"],[15,8,31,0],[15,9,31,0,"defineProperty"],[15,23,31,0],[15,24,31,0,"exports"],[15,31,31,0],[16,4,31,0,"enumerable"],[16,14,31,0],[17,4,31,0,"get"],[17,7,31,0],[17,18,31,0,"get"],[17,19,31,0],[18,6,31,0],[18,13,31,0,"useAuth"],[18,20,31,0],[19,4,31,0],[20,2,31,0],[21,2,33,0,"Object"],[21,8,33,0],[21,9,33,0,"defineProperty"],[21,23,33,0],[21,24,33,0,"exports"],[21,31,33,0],[22,4,33,0,"enumerable"],[22,14,33,0],[23,4,33,0,"get"],[23,7,33,0],[23,18,33,0,"get"],[23,19,33,0],[24,6,33,0],[24,13,33,0,"AuthProvider"],[24,25,33,0],[25,4,33,0],[26,2,33,0],[27,2,119,2],[27,6,119,2,"_expoVirtualEnv"],[27,21,119,2],[27,24,119,2,"require"],[27,31,119,2],[27,32,119,2,"_dependencyMap"],[27,46,119,2],[28,2,1,0],[28,6,1,0,"_react"],[28,12,1,0],[28,15,1,0,"require"],[28,22,1,0],[28,23,1,0,"_dependencyMap"],[28,37,1,0],[29,2,2,0],[29,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[29,42,2,0],[29,45,2,0,"require"],[29,52,2,0],[29,53,2,0,"_dependencyMap"],[29,67,2,0],[30,2,2,0],[30,6,2,0,"AsyncStorage"],[30,18,2,0],[30,21,2,0,"_interopDefault"],[30,36,2,0],[30,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[30,73,2,0],[31,2,2,69],[31,6,2,69,"_reactJsxDevRuntime"],[31,25,2,69],[31,28,2,69,"require"],[31,35,2,69],[31,36,2,69,"_dependencyMap"],[31,50,2,69],[32,2,4,0],[32,8,4,6,"BACKEND_URL"],[32,19,4,17],[32,22,4,17,"_expoVirtualEnv"],[32,37,4,17],[32,38,4,17,"env"],[32,41,4,17],[32,42,4,17,"EXPO_PUBLIC_BACKEND_URL"],[32,65,4,55],[33,2,22,0],[33,8,22,6,"AuthContext"],[33,19,22,17],[33,35,22,20],[33,39,22,20,"createContext"],[33,45,22,33],[33,46,22,33,"createContext"],[33,59,22,33],[33,61,22,51],[34,4,23,2,"user"],[34,8,23,6],[34,10,23,8],[34,14,23,12],[35,4,24,2,"isLoading"],[35,13,24,11],[35,15,24,13],[35,19,24,17],[36,4,25,2,"isAuthenticated"],[36,19,25,17],[36,21,25,19],[36,26,25,24],[37,4,26,2,"login"],[37,9,26,7],[37,11,26,9],[37,17,26,9,"login"],[37,18,26,9],[37,23,26,21],[37,27,26,25],[38,4,27,2,"logout"],[38,10,27,8],[38,12,27,10],[38,18,27,10,"logout"],[38,19,27,10],[38,24,27,22],[38,25,27,23],[38,26,27,24],[39,4,28,2,"checkAuth"],[39,13,28,11],[39,15,28,13],[39,21,28,13,"checkAuth"],[39,22,28,13],[39,27,28,25],[39,28,28,26],[40,2,29,0],[40,3,29,1],[40,4,29,2],[41,2,31,7],[41,8,31,13,"useAuth"],[41,15,31,20],[41,18,31,23,"useAuth"],[41,19,31,23],[42,4,31,23,"_s"],[42,6,31,23],[43,4,31,23],[43,11,31,29],[43,15,31,29,"useContext"],[43,21,31,39],[43,22,31,39,"useContext"],[43,32,31,39],[43,34,31,40,"AuthContext"],[43,45,31,51],[43,46,31,52],[44,2,31,52],[45,2,31,53,"_s"],[45,4,31,53],[45,5,31,13,"useAuth"],[45,12,31,20],[46,2,33,7],[46,8,33,13,"AuthProvider"],[46,20,33,66],[46,23,33,69,"AuthProvider"],[46,24,33,70],[47,4,33,72,"children"],[48,2,33,81],[48,3,33,82],[48,8,33,87],[49,4,33,87,"_s2"],[49,7,33,87],[50,4,34,2],[50,10,34,8],[50,11,34,9,"user"],[50,15,34,13],[50,17,34,15,"setUser"],[50,24,34,22],[50,25,34,23],[50,28,34,26],[50,32,34,26,"useState"],[50,38,34,34],[50,39,34,34,"useState"],[50,47,34,34],[50,49,34,48],[50,53,34,52],[50,54,34,53],[51,4,35,2],[51,10,35,8],[51,11,35,9,"isLoading"],[51,20,35,18],[51,22,35,20,"setIsLoading"],[51,34,35,32],[51,35,35,33],[51,38,35,36],[51,42,35,36,"useState"],[51,48,35,44],[51,49,35,44,"useState"],[51,57,35,44],[51,59,35,45],[51,63,35,49],[51,64,35,50],[52,4,37,2],[52,10,37,8,"checkAuth"],[52,19,37,17],[52,22,37,20],[52,26,37,20,"useCallback"],[52,32,37,31],[52,33,37,31,"useCallback"],[52,44,37,31],[52,46,37,32],[52,58,37,44],[53,6,38,4],[53,10,38,8],[54,8,39,6],[54,14,39,12,"storedToken"],[54,25,39,23],[54,28,39,26],[54,34,39,32,"AsyncStorage"],[54,46,39,44],[54,47,39,44,"default"],[54,54,39,44],[54,55,39,45,"getItem"],[54,62,39,52],[54,63,39,53],[54,78,39,68],[54,79,39,69],[55,8,40,6],[55,12,40,10],[55,13,40,11,"storedToken"],[55,24,40,22],[55,26,40,24],[56,10,41,8,"setUser"],[56,17,41,15],[56,18,41,16],[56,22,41,20],[56,23,41,21],[57,10,42,8,"setIsLoading"],[57,22,42,20],[57,23,42,21],[57,28,42,26],[57,29,42,27],[58,10,43,8],[59,8,44,6],[60,8,45,6],[60,14,45,12,"resp"],[60,18,45,16],[60,21,45,19],[60,27,45,25,"fetch"],[60,32,45,30],[60,33,45,31],[60,36,45,34,"BACKEND_URL"],[60,47,45,45],[60,61,45,59],[60,63,45,61],[61,10,46,8,"headers"],[61,17,46,15],[61,19,46,17],[62,12,46,19],[62,27,46,34],[62,29,46,36],[62,39,46,46,"storedToken"],[62,50,46,57],[63,10,46,60],[63,11,46,61],[64,10,47,8,"credentials"],[64,21,47,19],[64,23,47,21],[65,8,48,6],[65,9,48,7],[65,10,48,8],[66,8,49,6],[66,12,49,10,"resp"],[66,16,49,14],[66,17,49,15,"ok"],[66,19,49,17],[66,21,49,19],[67,10,50,8],[67,16,50,14,"userData"],[67,24,50,22],[67,27,50,25],[67,33,50,31,"resp"],[67,37,50,35],[67,38,50,36,"json"],[67,42,50,40],[67,43,50,41],[67,44,50,42],[68,10,51,8,"setUser"],[68,17,51,15],[68,18,51,16,"userData"],[68,26,51,24],[68,27,51,25],[69,8,52,6],[69,9,52,7],[69,15,52,13],[70,10,53,8,"setUser"],[70,17,53,15],[70,18,53,16],[70,22,53,20],[70,23,53,21],[71,10,54,8],[71,16,54,14,"AsyncStorage"],[71,28,54,26],[71,29,54,26,"default"],[71,36,54,26],[71,37,54,27,"removeItem"],[71,47,54,37],[71,48,54,38],[71,63,54,53],[71,64,54,54],[72,8,55,6],[73,6,56,4],[73,7,56,5],[73,8,56,6],[73,14,56,12],[74,8,57,6,"setUser"],[74,15,57,13],[74,16,57,14],[74,20,57,18],[74,21,57,19],[75,6,58,4],[75,7,58,5],[75,16,58,14],[76,8,59,6,"setIsLoading"],[76,20,59,18],[76,21,59,19],[76,26,59,24],[76,27,59,25],[77,6,60,4],[78,4,61,2],[78,5,61,3],[78,7,61,5],[78,9,61,7],[78,10,61,8],[79,4,63,2],[79,8,63,2,"useEffect"],[79,14,63,11],[79,15,63,11,"useEffect"],[79,24,63,11],[79,26,63,12],[79,32,63,18],[80,6,64,4,"checkAuth"],[80,15,64,13],[80,16,64,14],[80,17,64,15],[81,4,65,2],[81,5,65,3],[81,7,65,5],[81,8,65,6,"checkAuth"],[81,17,65,15],[81,18,65,16],[81,19,65,17],[82,4,67,2],[82,10,67,8,"login"],[82,15,67,13],[82,18,67,16],[82,24,67,23,"sessionId"],[82,33,67,40],[82,37,67,67],[83,6,68,4],[83,10,68,8],[84,8,69,6],[84,14,69,12,"resp"],[84,18,69,16],[84,21,69,19],[84,27,69,25,"fetch"],[84,32,69,30],[84,33,69,31],[84,36,69,34,"BACKEND_URL"],[84,47,69,45],[84,66,69,64],[84,68,69,66],[85,10,70,8,"method"],[85,16,70,14],[85,18,70,16],[85,24,70,22],[86,10,71,8,"headers"],[86,17,71,15],[86,19,71,17],[87,12,71,19],[87,26,71,33],[87,28,71,35],[88,10,71,54],[88,11,71,55],[89,10,72,8,"body"],[89,14,72,12],[89,16,72,14,"JSON"],[89,20,72,18],[89,21,72,19,"stringify"],[89,30,72,28],[89,31,72,29],[90,12,72,31,"session_id"],[90,22,72,41],[90,24,72,43,"sessionId"],[91,10,72,53],[91,11,72,54],[91,12,72,55],[92,10,73,8,"credentials"],[92,21,73,19],[92,23,73,21],[93,8,74,6],[93,9,74,7],[93,10,74,8],[94,8,75,6],[94,12,75,10],[94,13,75,11,"resp"],[94,17,75,15],[94,18,75,16,"ok"],[94,20,75,18],[94,22,75,20],[94,29,75,27],[94,33,75,31],[95,8,76,6],[95,14,76,12,"userData"],[95,22,76,20],[95,25,76,23],[95,31,76,29,"resp"],[95,35,76,33],[95,36,76,34,"json"],[95,40,76,38],[95,41,76,39],[95,42,76,40],[97,8,78,6],[98,8,79,6],[98,12,79,10,"userData"],[98,20,79,18],[98,21,79,19,"session_token"],[98,34,79,32],[98,36,79,34],[99,10,80,8],[99,16,80,14,"AsyncStorage"],[99,28,80,26],[99,29,80,26,"default"],[99,36,80,26],[99,37,80,27,"setItem"],[99,44,80,34],[99,45,80,35],[99,60,80,50],[99,62,80,52,"userData"],[99,70,80,60],[99,71,80,61,"session_token"],[99,84,80,74],[99,85,80,75],[100,8,81,6],[102,8,83,6],[103,8,84,6],[103,12,84,10],[103,13,84,11,"userData"],[103,21,84,19],[103,22,84,20,"session_token"],[103,35,84,33],[103,37,84,35],[104,10,85,8],[104,16,85,14,"cookies"],[104,23,85,21],[104,26,85,24,"resp"],[104,30,85,28],[104,31,85,29,"headers"],[104,38,85,36],[104,39,85,37,"get"],[104,42,85,40],[104,43,85,41],[104,55,85,53],[104,56,85,54],[105,10,86,8],[105,14,86,12,"cookies"],[105,21,86,19],[105,23,86,21],[106,12,87,10],[106,18,87,16,"tokenMatch"],[106,28,87,26],[106,31,87,29,"cookies"],[106,38,87,36],[106,39,87,37,"match"],[106,44,87,42],[106,45,87,43],[106,68,87,66],[106,69,87,67],[107,12,88,10],[107,16,88,14,"tokenMatch"],[107,26,88,24],[107,28,88,26],[108,14,89,12],[108,20,89,18,"AsyncStorage"],[108,32,89,30],[108,33,89,30,"default"],[108,40,89,30],[108,41,89,31,"setItem"],[108,48,89,38],[108,49,89,39],[108,64,89,54],[108,66,89,56,"tokenMatch"],[108,76,89,66],[108,77,89,67],[108,78,89,68],[108,79,89,69],[108,80,89,70],[109,12,90,10],[110,10,91,8],[111,8,92,6],[112,8,94,6,"setUser"],[112,15,94,13],[112,16,94,14,"userData"],[112,24,94,22],[112,25,94,23],[113,8,95,6],[113,15,95,13,"userData"],[113,23,95,21],[114,6,96,4],[114,7,96,5],[114,8,96,6],[114,14,96,12],[115,8,97,6],[115,15,97,13],[115,19,97,17],[116,6,98,4],[117,4,99,2],[117,5,99,3],[118,4,101,2],[118,10,101,8,"logout"],[118,16,101,14],[118,19,101,17],[118,25,101,17,"logout"],[118,26,101,17],[118,31,101,29],[119,6,102,4],[119,10,102,8],[120,8,103,6],[120,14,103,12,"storedToken"],[120,25,103,23],[120,28,103,26],[120,34,103,32,"AsyncStorage"],[120,46,103,44],[120,47,103,44,"default"],[120,54,103,44],[120,55,103,45,"getItem"],[120,62,103,52],[120,63,103,53],[120,78,103,68],[120,79,103,69],[121,8,104,6],[121,14,104,12,"fetch"],[121,19,104,17],[121,20,104,18],[121,23,104,21,"BACKEND_URL"],[121,34,104,32],[121,52,104,50],[121,54,104,52],[122,10,105,8,"method"],[122,16,105,14],[122,18,105,16],[122,24,105,22],[123,10,106,8,"headers"],[123,17,106,15],[123,19,106,17,"storedToken"],[123,30,106,28],[123,33,106,31],[124,12,106,33],[124,27,106,48],[124,29,106,50],[124,39,106,60,"storedToken"],[124,50,106,71],[125,10,106,74],[125,11,106,75],[125,14,106,78],[125,15,106,79],[125,16,106,80],[126,10,107,8,"credentials"],[126,21,107,19],[126,23,107,21],[127,8,108,6],[127,9,108,7],[127,10,108,8],[128,6,109,4],[128,7,109,5],[128,8,109,6],[128,14,109,12],[128,15,109,14],[129,6,110,4],[129,12,110,10,"AsyncStorage"],[129,24,110,22],[129,25,110,22,"default"],[129,32,110,22],[129,33,110,23,"removeItem"],[129,43,110,33],[129,44,110,34],[129,59,110,49],[129,60,110,50],[130,6,111,4,"setUser"],[130,13,111,11],[130,14,111,12],[130,18,111,16],[130,19,111,17],[131,4,112,2],[131,5,112,3],[132,4,114,2],[132,24,115,4],[132,28,115,4,"_reactJsxDevRuntime"],[132,47,115,4],[132,48,115,4,"jsxDEV"],[132,54,115,4],[132,56,115,5,"AuthContext"],[132,67,115,16],[132,68,115,17,"Provider"],[132,76,115,25],[133,6,115,26,"value"],[133,11,115,31],[133,13,115,33],[134,8,115,35,"user"],[134,12,115,39],[135,8,115,41,"isLoading"],[135,17,115,50],[136,8,115,52,"isAuthenticated"],[136,23,115,67],[136,25,115,69],[136,26,115,70],[136,27,115,71,"user"],[136,31,115,75],[137,8,115,77,"login"],[137,13,115,82],[138,8,115,84,"logout"],[138,14,115,90],[139,8,115,92,"checkAuth"],[140,6,115,102],[140,7,115,104],[141,6,115,104,"children"],[141,14,115,104],[141,16,116,7,"children"],[142,4,116,15],[143,6,116,15,"fileName"],[143,14,116,15],[143,16,116,15,"_jsxFileName"],[143,28,116,15],[144,6,116,15,"lineNumber"],[144,16,116,15],[145,6,116,15,"columnNumber"],[145,18,116,15],[146,4,116,15],[146,11,117,26],[146,12,117,27],[147,2,119,0],[147,3,119,1],[148,2,119,2,"_s2"],[148,5,119,2],[148,6,33,13,"AuthProvider"],[148,18,33,66],[149,2,33,66,"_c"],[149,4,33,66],[149,7,33,13,"AuthProvider"],[149,19,33,66],[150,2,33,66],[150,6,33,66,"_c"],[150,8,33,66],[151,2,33,66,"$RefreshReg$"],[151,14,33,66],[151,15,33,66,"_c"],[151,17,33,66],[152,0,33,66],[152,3]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.checkAuth","useAuth","AuthProvider","checkAuth","useEffect$argument_0","login","logout"],"mappings":"AAA;SCyB,gBD;UEC,cF;aGC,cH;uBIG,6BJ;qEKE;gCCI;GDwB;YEE;GFE;gBGE;GHgC;iBIE;GJW;CLO"},"hasCjsExports":false},"type":"js/module"}]}